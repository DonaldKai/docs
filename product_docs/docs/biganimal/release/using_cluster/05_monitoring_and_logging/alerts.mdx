---
title: "Setting real-time alerts"

---

This page show you how you can use a Log Analytics query to evaluate resource logs at a predefined frequency in Azure.

Assume that your cluster is on a subscription called development and is being accessed from a Linux client VM on another subscription called test with the following properties:

Cluster:
Subscription: development
Cluster ID: p-c4j0jfcmp3af2ieok5eg
Account ID: brcxzr08qr7rbei1
Organization's domain name: biganimal.io
Linux client VM called vm-client:
Subscription: test
Resource group: rg-client



1. In the Azure portal, search for and select **Alerts**. BigAnimal instances collect various metrics, which appear in the Alerts page, as follows:

mceclip0.png

1. Select **+ Create** and select **Alert rule** option to create new alert rule.

mceclip1.png

1. Select **+ Select scope**. Under Select a resource:
    1. Select your Azure subscription in the Filter by subscription field. 
    1. Select **Log Analytics workspaces** in the Filter by resource type field.
    1. Select the Azure region of your cluster in the **Filter by location** field. 
    
1. BigAnimal has create a Log Analytics workspaces for each region in your Azure subscription. Select the Log Analytics workspace for your region and select **Done**.

1. In the Condition tab, select **Add condition** to set when alert rule is triggered. Select **Add condition** and then select **Custom log search**.

1. Enter the following query: Below shows an query example of metrics for a database cluster, "p-gjlmcos8n7" is the database cluster ID, "cnp_collector_up" is the metrics name.

    ```text
    DpMetrics_CL
    | where Message has "cnp_collector_up"
    | extend m = todynamic(Message)
    | where m.labels.role == "primary" and m.labels.postgresql == "p-gjlmcos8n7"
    ```
1. Design the alert logic based on number of results. Under Alert logic:
    1. Select **Number of results** to base the alert logic on. 
    1. Select the **Operator** as *Equals*. 
    1. Enter **0** in the Threshold value field.

Set the Azure alert logic as Number of results Equal to 0, it means if there is no metrics of "cnp_collector_up" for the database cluster, the alert will be triggered. It can indicate the monitoring problem or database cluster is unavailable which is critical.

8. Configure the Actions and following steps by following instructions shown at document.

Note
Above sample shows the alert based on no monitoring metrics for the database cluster, you can define alert logic based on metrics measurements, BigAnimal provides a wide set of metrics about Postgres instances as shown at the document.